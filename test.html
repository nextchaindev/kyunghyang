<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Kyunghyang News</title>
    <!-- <link rel="icon" type="image/x-icon" href="/images/favicon.ico" /> -->
    <meta name="keywords" content="Kyunghyang News" />
    <meta name="description" content="Kyunghyang News" />
    <meta name="author" content="Kyunghyang News" />

    <link rel="stylesheet" href="/styles/color.css" />
    <link rel="stylesheet" href="/styles/global.css" />
    <link rel="stylesheet" href="/styles/pages/01.css" />
    <link rel="stylesheet" href="/styles/animations/01.animation.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/flickity@2/dist/flickity.min.css"
    />

    <style>
      body,
      html {
        overflow-y: auto;
      }
      section {
        position: relative;
        height: 100vh;
        border-bottom: 1px solid #636363;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.3);
      }
      h1 {
        position: absolute;
        top: 30px;
        font-size: 36px;
        line-height: 1;
        font-family: sans-serif;
        color: #fff;
        margin: 0 0 0 20px;
      }
      .right-side {
        width: 100%;
        position: fixed;
        right: 0;
        top: 0;
        background: #333;
        height: 100vh;
        overflow: hidden;
      }
      .photo {
        width: 100%;
        height: 100%;
        background-image: url(https://www.voicesofyouth.org/sites/voy/files/images/2020-08/finding-sunshine.jpg);
        background-size: cover;
        background-position: center;
      }
    </style>
  </head>
  <body class="kyunghyang-news page01">
    <div class="fullscreen" style="background: pink"></div>
    <div id="right-side">
      <div class="photo"></div>
    </div>
    <section>
      <h1>ScrollTrigger Zoom by Section</h1>
    </section>
    <section>
      <h1>Section 2</h1>
    </section>
    <section>
      <h1>Section 3</h1>
    </section>
    <section>
      <h1>Section 4</h1>
    </section>
    <div class="fullscreen" style="background: pink"></div>
    <!-- scripts -->

    <!-- animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
    <script>
      gsap.registerEffect({
        name: "zoom",
        effect: (targets, config) => {
          const vars = { transformOrigin: "0px 0px", ...config },
            { scale, origin } = config,
            clamp = gsap.utils.clamp(-100 * (scale - 1), 0);
          delete vars.origin;
          vars.xPercent = clamp((0.5 - origin[0] * scale) * 100);
          vars.yPercent = clamp((0.5 - origin[1] * scale) * 100);
          vars.overwrite = "auto";
          return gsap.to(targets, vars);
        },
        extendTimeline: true,
        defaults: { origin: [0.5, 0.5], scale: 2 },
      });

      // for each section, we define the zoom data here
      const zoomData = [
        { scale: 1, origin: [0.5, 0.5] },
        { scale: 3, origin: [0.6, 1] },
        { scale: 1, origin: [0.5, 0.5] },
        { scale: 2, origin: [0.8, 0.4] },
      ];

      gsap.utils.toArray("section").forEach((section, index) => {
        const zoom = zoomData[index];
        ScrollTrigger.create({
          trigger: section,
          onToggle(self) {
            if (self.isActive) {
              // if it enters forward or backward
              gsap.effects.zoom(".photo", {
                scale: zoom.scale,
                origin: zoom.origin,
                duration: 1,
                ease: "power1.inOut",
              });
            }
          },
          onEnter() {
            if (index === 0) {
              document.getElementById("right-side").classList.add("right-side");
            }
          },
          onLeave() {
            if (index === gsap.utils.toArray("section").length - 1) {
              document
                .getElementById("right-side")
                .classList.remove("right-side");
            }
          },
          onEnterBack() {
            if (index === gsap.utils.toArray("section").length - 1) {
              document.getElementById("right-side").classList.add("right-side");
            }
          },
          onLeaveBack() {
            if (index === 0) {
              document
                .getElementById("right-side")
                .classList.remove("right-side");
            }
          },
        });
      });
    </script>
  </body>
</html>
